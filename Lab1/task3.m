% 1. Параметры
a = 4; b = 2; t0 = 1; t1 = 2; t2 = 3;
T = t2 - t0;
N_max = 50;

% Описываем функцию f(t)
f_handle = @(t) a .* (mod(t-t0, T) < (t1-t0)) + b .* (mod(t-t0, T) >= (t1-t0));

% 2. Получаем коэффициенты через нашу функцию
[an, bn, cn, nn] = calc_fourier(f_handle, t0, T, N_max);

% 3. Средний квадрат нормы оригинала (левая часть равенства Парсеваля)
% Формула: (1/T) * ||f||^2 = (1/T) * интеграл |f(t)|^2 dt
norm_sq_avg = (1/T) * integral(@(t) f_handle(t).^2, t0, t0 + T);

% 4. Сумма квадратов коэффициентов тригонометрического ряда (FN)
% Соответствует среднему квадрату нормы аппроксимации
norm_sq_FN = (an(1)/2)^2 + 0.5 * sum(an(2:end).^2 + bn(2:end).^2);

% 5. Сумма квадратов коэффициентов комплексного ряда (GN)
norm_sq_GN = sum(abs(cn).^2);

% --- Вывод результатов ---
fprintf('--- Проверка равенства Парсеваля (N = %d) ---\n', N_max);
fprintf('Средний квадрат нормы оригинала:        %.10f\n', norm_sq_avg);
fprintf('Сумма кв. коэфф. триг. ряда (FN):       %.10f\n', norm_sq_FN);
fprintf('Сумма кв. коэфф. компл. ряда (GN):      %.10f\n', norm_sq_GN);

fprintf('\nПогрешность аппроксимации нормы:        %.10f\n', norm_sq_avg - norm_sq_FN);